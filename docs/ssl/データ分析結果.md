# data_lowF_noise.pickle データ分析結果

## データの基本構造

このpickleファイルは**辞書型**で、以下の2つのキーを持っています：

- **`x`**: PSDデータ（入力データ）
- **`y`**: ラベルデータ（ノイズ区間の情報）

---

## キー 'x' - PSDデータ（入力データ）

### 基本情報
- **型**: `torch.Tensor`
- **形状**: `[32000, 1, 3000]`
  - 32,000件のサンプル
  - 1チャンネル
  - 各サンプルは3,000ポイントの時系列データ
- **データ型**: `torch.float32`
- **メモリ使用量**: 約366 MB

### 統計情報
- **最小値**: 6.74 × 10⁻²⁷
- **最大値**: 3.77 × 10⁻²³
- **平均値**: 7.18 × 10⁻²⁶
- **標準偏差**: 9.51 × 10⁻²⁵

### 特徴
- PSDデータは非常に小さな値（10⁻²³〜10⁻²⁷程度）
- 各サンプルは `[1, 3000]` の形状で、周波数領域のデータを表している
- 最初の要素は大きめの値で、後ろに行くほど小さくなる傾向（減衰特性）

### サンプルデータ（最初のサンプル）
```
x[0] の最初の10要素:
[3.61e-23, 2.79e-23, 2.02e-23, 1.46e-23, 1.07e-23, 
 8.13e-24, 6.32e-24, 5.03e-24, 4.09e-24, 3.38e-24]

x[0] の最後の10要素:
[1.10e-26, 1.10e-26, 1.10e-26, 1.10e-26, 1.10e-26,
 1.10e-26, 1.10e-26, 1.10e-26, 1.10e-26, 1.10e-26]
```

---

## キー 'y' - ラベルデータ

### 基本情報
- **型**: `torch.Tensor`
- **形状**: `[32000, 2]`
  - 32,000件のサンプル
  - 各サンプルは2つの値を持つ
- **データ型**: `torch.float32`

### 統計情報
- **最小値**: 0.01
- **最大値**: 3.25
- **平均値**: 1.63
- **標準偏差**: 0.85

### 解釈
`y` の2つの値は、おそらく**ノイズ区間の開始位置と終了位置**を表しています：

- **`y[i][0]`**: ノイズ区間の開始位置（正規化された値、0〜3の範囲）
- **`y[i][1]**: ノイズ区間の終了位置（正規化された値、0〜3の範囲）

または、ノイズの位置情報を別の形式で表している可能性もあります。

### サンプルデータ
```
y[0] = [0.7400, 1.8329]  # ノイズ区間: 0.74〜1.83
y[1] = [1.0800, 1.9535]  # ノイズ区間: 1.08〜1.95
y[2] = [1.7300, 2.9887]  # ノイズ区間: 1.73〜2.99
```

---

## データセットの全体像

### データの対応関係
- 各サンプル `i` について：
  - `x[i]`: 形状 `[1, 3000]` のPSDデータ
  - `y[i]`: 形状 `[2]` のラベル（ノイズ区間の情報）

### 研究での使い方
1. **入力**: `x[i]` - PSDデータ（3,000ポイントの時系列）
2. **出力（目標）**: ノイズ区間を検出（アテンションウェイトを使用）
3. **教師データ（参考）**: `y[i]` - ノイズ区間の位置情報

**注意**: 研究では自己教師学習を使うため、`y` のラベルは直接使わず、入力データ `x` だけで学習する予定です。

---

## データの可視化のヒント

### PSDデータの可視化
```python
import matplotlib.pyplot as plt
import torch

# サンプルを可視化
sample_idx = 0
psd_data = data['x'][sample_idx].squeeze()  # [3000]

plt.figure(figsize=(12, 4))
plt.plot(psd_data.numpy())
plt.xlabel('Frequency Index')
plt.ylabel('PSD Value')
plt.title(f'PSD Data Sample {sample_idx}')
plt.yscale('log')  # 対数スケール推奨
plt.show()
```

### ノイズ区間の可視化
```python
# ノイズ区間を可視化
noise_start = data['y'][sample_idx][0]
noise_end = data['y'][sample_idx][1]

plt.axvspan(noise_start * 1000, noise_end * 1000, 
            alpha=0.3, color='red', label='Noise Region')
```

---

## 次のステップ

1. **データの可視化**: いくつかのサンプルをプロットして、PSDデータとノイズ区間の関係を理解する
2. **データ前処理**: 必要に応じて正規化やログ変換を検討
3. **自己教師学習タスクの設計**: このデータに適した自己教師学習タスクを考える
4. **モデル設計**: Transformerベースのモデルを設計し、アテンションウェイトを活用

